"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/api/chat/route",{

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/esm/server/web/exports/next-response.js\");\n/* harmony import */ var _config_prompts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/config/prompts */ \"(rsc)/./src/config/prompts.ts\");\n\n\nconst runtime = \"edge\";\nasync function POST(req) {\n    try {\n        const { messages } = await req.json();\n        // 获取用户消息\n        const userMessage = messages[0].content;\n        console.log(\"用户消息:\", userMessage);\n        // 调用 AiHubMix API\n        const response = await fetch(\"https://aihubmix.com/v1/chat/completions\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": `Bearer ${process.env.ANTHROPIC_API_KEY}`\n            },\n            body: JSON.stringify({\n                model: \"gpt-3.5-turbo\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: _config_prompts__WEBPACK_IMPORTED_MODULE_1__.SYSTEM_PROMPTS.default\n                    },\n                    ...messages\n                ],\n                temperature: 0.7,\n                max_tokens: 1000\n            })\n        });\n        if (!response.ok) {\n            const errorText = await response.text();\n            console.error(\"API错误:\", response.status, errorText);\n            throw new Error(`API错误: ${response.status} ${errorText}`);\n        }\n        const data = await response.json();\n        console.log(\"API响应摘要:\", data.choices?.[0]?.message);\n        // 获取原始消息内容\n        let content = data.choices[0].message.content;\n        // 移除所有 <think>...</think> 标签内容\n        content = content.replace(/<think>[\\s\\S]*?<\\/think>/g, \"\");\n        // 移除可能残留的空行\n        content = content.replace(/\\n\\s*\\n/g, \"\\n\").trim();\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            message: content\n        });\n    } catch (error) {\n        console.error(\"错误:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"请求处理失败\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2NoYXQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEyQztBQUNPO0FBRTNDLE1BQU1FLFVBQVUsT0FBTztBQUV2QixlQUFlQyxLQUFLQyxHQUFZO0lBQ3JDLElBQUk7UUFDRixNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHLE1BQU1ELElBQUlFLElBQUk7UUFFbkMsU0FBUztRQUNULE1BQU1DLGNBQWNGLFFBQVEsQ0FBQyxFQUFFLENBQUNHLE9BQU87UUFDdkNDLFFBQVFDLEdBQUcsQ0FBQyxTQUFTSDtRQUVyQixrQkFBa0I7UUFDbEIsTUFBTUksV0FBVyxNQUFNQyxNQUFNLDRDQUE0QztZQUN2RUMsUUFBUTtZQUNSQyxTQUFTO2dCQUNQLGdCQUFnQjtnQkFDaEIsaUJBQWlCLENBQUMsT0FBTyxFQUFFQyxRQUFRQyxHQUFHLENBQUNDLGlCQUFpQixDQUFDLENBQUM7WUFDNUQ7WUFDQUMsTUFBTUMsS0FBS0MsU0FBUyxDQUFDO2dCQUNuQkMsT0FBTztnQkFDUGhCLFVBQVU7b0JBQ1I7d0JBQUVpQixNQUFNO3dCQUFVZCxTQUFTUCwyREFBY0EsQ0FBQ3NCLE9BQU87b0JBQUM7dUJBQy9DbEI7aUJBQ0o7Z0JBQ0RtQixhQUFhO2dCQUNiQyxZQUFZO1lBQ2Q7UUFDRjtRQUVBLElBQUksQ0FBQ2QsU0FBU2UsRUFBRSxFQUFFO1lBQ2hCLE1BQU1DLFlBQVksTUFBTWhCLFNBQVNpQixJQUFJO1lBQ3JDbkIsUUFBUW9CLEtBQUssQ0FBQyxVQUFVbEIsU0FBU21CLE1BQU0sRUFBRUg7WUFDekMsTUFBTSxJQUFJSSxNQUFNLENBQUMsT0FBTyxFQUFFcEIsU0FBU21CLE1BQU0sQ0FBQyxDQUFDLEVBQUVILFVBQVUsQ0FBQztRQUMxRDtRQUVBLE1BQU1LLE9BQU8sTUFBTXJCLFNBQVNMLElBQUk7UUFDaENHLFFBQVFDLEdBQUcsQ0FBQyxZQUFZc0IsS0FBS0MsT0FBTyxFQUFFLENBQUMsRUFBRSxFQUFFQztRQUUzQyxXQUFXO1FBQ1gsSUFBSTFCLFVBQVV3QixLQUFLQyxPQUFPLENBQUMsRUFBRSxDQUFDQyxPQUFPLENBQUMxQixPQUFPO1FBRTdDLCtCQUErQjtRQUMvQkEsVUFBVUEsUUFBUTJCLE9BQU8sQ0FBQyw2QkFBNkI7UUFDdkQsWUFBWTtRQUNaM0IsVUFBVUEsUUFBUTJCLE9BQU8sQ0FBQyxZQUFZLE1BQU1DLElBQUk7UUFFaEQsT0FBT3BDLGtGQUFZQSxDQUFDTSxJQUFJLENBQUM7WUFDdkI0QixTQUFTMUI7UUFDWDtJQUNGLEVBQUUsT0FBT3FCLE9BQVk7UUFDbkJwQixRQUFRb0IsS0FBSyxDQUFDLE9BQU9BO1FBQ3JCLE9BQU83QixrRkFBWUEsQ0FBQ00sSUFBSSxDQUN0QjtZQUFFdUIsT0FBTztZQUFVUSxTQUFTUixNQUFNSyxPQUFPO1FBQUMsR0FDMUM7WUFBRUosUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vYXBwL2FwaS9jaGF0L3JvdXRlLnRzP2RlNDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgU1lTVEVNX1BST01QVFMgfSBmcm9tICdAL2NvbmZpZy9wcm9tcHRzJztcblxuZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSAnZWRnZSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgbWVzc2FnZXMgfSA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgXG4gICAgLy8g6I635Y+W55So5oi35raI5oGvXG4gICAgY29uc3QgdXNlck1lc3NhZ2UgPSBtZXNzYWdlc1swXS5jb250ZW50O1xuICAgIGNvbnNvbGUubG9nKCfnlKjmiLfmtojmga86JywgdXNlck1lc3NhZ2UpO1xuICAgIFxuICAgIC8vIOiwg+eUqCBBaUh1Yk1peCBBUElcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FpaHVibWl4LmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Byb2Nlc3MuZW52LkFOVEhST1BJQ19BUElfS0VZfWBcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG1vZGVsOiBcImdwdC0zLjUtdHVyYm9cIixcbiAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBTWVNURU1fUFJPTVBUUy5kZWZhdWx0IH0sXG4gICAgICAgICAgLi4ubWVzc2FnZXNcbiAgICAgICAgXSxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgbWF4X3Rva2VuczogMTAwMFxuICAgICAgfSlcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0FQSemUmeivrzonLCByZXNwb25zZS5zdGF0dXMsIGVycm9yVGV4dCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFQSemUmeivrzogJHtyZXNwb25zZS5zdGF0dXN9ICR7ZXJyb3JUZXh0fWApO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgY29uc29sZS5sb2coJ0FQSeWTjeW6lOaRmOimgTonLCBkYXRhLmNob2ljZXM/LlswXT8ubWVzc2FnZSk7XG4gICAgXG4gICAgLy8g6I635Y+W5Y6f5aeL5raI5oGv5YaF5a65XG4gICAgbGV0IGNvbnRlbnQgPSBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuICAgIFxuICAgIC8vIOenu+mZpOaJgOaciSA8dGhpbms+Li4uPC90aGluaz4g5qCH562+5YaF5a65XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvPHRoaW5rPltcXHNcXFNdKj88XFwvdGhpbms+L2csICcnKTtcbiAgICAvLyDnp7vpmaTlj6/og73mrovnlZnnmoTnqbrooYxcbiAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXG5cXHMqXFxuL2csICdcXG4nKS50cmltKCk7XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIG1lc3NhZ2U6IGNvbnRlbnRcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+mUmeivrzonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ+ivt+axguWkhOeQhuWksei0pScsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIlNZU1RFTV9QUk9NUFRTIiwicnVudGltZSIsIlBPU1QiLCJyZXEiLCJtZXNzYWdlcyIsImpzb24iLCJ1c2VyTWVzc2FnZSIsImNvbnRlbnQiLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJwcm9jZXNzIiwiZW52IiwiQU5USFJPUElDX0FQSV9LRVkiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm1vZGVsIiwicm9sZSIsImRlZmF1bHQiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJvayIsImVycm9yVGV4dCIsInRleHQiLCJlcnJvciIsInN0YXR1cyIsIkVycm9yIiwiZGF0YSIsImNob2ljZXMiLCJtZXNzYWdlIiwicmVwbGFjZSIsInRyaW0iLCJkZXRhaWxzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ })

});